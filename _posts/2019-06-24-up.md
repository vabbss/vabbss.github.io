---
bแป cแปฅc: bรi
title: Cรกch tแบกo trแบกm bแบฃn ฤแป vแปi cฦก sแป dแปฏ liแปu MySQL
cรกc thแบป: [MySQL, cฦก sแป dแปฏ liแปu, trแบกm bแบฃn ฤแป, PHP]
---

Gแบงn ฤรขy, tรดi ฤรฃ mua mแปt cฦก sแป dแปฏ liแปu 500GB. Hรฃy suy nghฤฉ vแป cรกch sแปญ dแปฅng nรณ? <! - more ->

# Nรณi lร rแบป, cho tรดi xem mรฃ

Bแบฃng tแบกo cฦก sแป dแปฏ liแปu:
`` sql
TแบO BแบขNG `FileUP` (
`ID` int (11) NOT NULL AUTO_INCREMENT,
Vฤn bแบฃn `tรชn` KHรNG ฤแบฆY ฤแปฆ,
`Tแปp` longblob KHรNG ฤแบฆY ฤแปฆ,
`Kรญch thฦฐแปc` int (11) KHรNG ฤแบฆY,
KHรA CHรNH (`ID`)
) ENGINE = InnoDB DEFAULT CHARSET = gb2312;
``

Mรฃ PHP:
`` php
<? php
$ con = mysqli_connect ("ฤแปa chแป cฦก sแป dแปฏ liแปu", "tรชn ngฦฐแปi dรนng", "mแบญt khแบฉu", "tรชn cฦก sแป dแปฏ liแปu");
if (mysqli_connect_errno ($ con))
{
    die ("Khรดng kแบฟt nแปi ฤฦฐแปฃc vแปi MySQL:". mysqli_connect_error ());
}

if ($ _GET [ID]! = '') {
    header ('Access-Control-Allow-Origin: *');
    $ sql = "CHแปN * Tแปช` FileUP` WHERE `ID` = '". addlashes ($ _ GET [ID]). "'";
    $ result = $ con-> query ($ sql);
    if ($ result-> num_rows> 0) {
        while ($ row = $ result-> fetch_assoc ()) {
         Header ("Loแบกi nแปi dung: application / octet-stream");
         Header ("Chแบฅp nhแบญn-Phแบกm vi: byte");
         Header ("ฤแป dรi chแบฅp nhแบญn:". $ Row ["Kรญch thฦฐแปc"]);
         Header ("Nแปi dung-Bแป trรญ: tแปp ฤรญnh kรจm; tรชn tแปp =". $ Row ["Tรชn"]);
        echo $ row ["Tแปp"];
    }
}
    khรกc {
 header ('HTTP / 1.1 404 KHรNG TรM HIแปU');
}
} khรกc {
echo '<title> Giฦฐแปng hรฌnh Mayx </title>
<h1> Giฦฐแปng hรฌnh Mayx </h1> <hr>
Vui lรฒng chแปn tแปp ฤแป tแบฃi lรชn
<form enctype = "multiart / form-data" method = "post" action = "">
  <input type = "file" name = "File" />
  <input type = "submit" name = "submit" value = "submit" />
</form>
<br /> ';
if ($ _SERVER ['REQUEST_METHOD'] == "POST") {
 $ error = $ _FILES ['File'] ['error'];
 $ tmp_name = $ _FILES ['Tแปp'] ['tmp_name'];
 $ size = $ _FILES ['File'] ['size'];
 $ name = $ _FILES ['Tแปp'] ['tรชn'];
 print ("\ n");
 if ($ error == UPLOAD_ERR_OK && $ size> 0) {
  $ fp = fopen ($ tmp_name, 'r');
  $ content = fread ($ fp, $ size);
  fclose ($ fp);
  $ content = addlashes ($ content);
  $ sql = "CHรN VรO` FileUP` (`Tรชn`,` Tแปp`, `Kรญch thฦฐแปc`)
 VALUES ('". $ Name."', '". $ Content."', '". $ Size."'); ";
  $ con-> truy vแบฅn ($ sql);
  $ sql = "chแปn @@ danh tรญnh;";
  $ result = $ con-> query ($ sql);
while ($ row = $ result-> fetch_assoc ()) {
echo'Upload hoรn tแบฅt, ฤแปa chแป tแบฃi xuแปng tแปp: <a href = "//'.$_ SERVER ['HTTP_HOST']. $ _ SERVER ['REQUEST_URI']."? ID = ". $ row ['@@ ID'] . '">'. $ _ SERVER ['HTTP_X_FORWARDED_PROTO']. ': //'.$_SERVER [' HTTP_HOST ']. $ _ SERVER [' REQUEST_URI ']."? ID = ". $ Row [' @@ ID ' ]. '</a>';
}

 } khรกc {
  echo "Lแปi tแบฃi lรชn tแปp!";
 }

}

echo '<hr />
<center> <a href="https://mabbs.github.io/"> Bแปi Mayx </a> </center> ';

}

mysqli_close ($ con);
``

# sแปฑ thiแบฟu sรณt
  ~~ MySQL cรณ giแปi hแบกn trong viแปc lฦฐu tแปp, cรณ vแบป nhฦฐ nรณ chแป cรณ thแป lฦฐu khoแบฃng 16MB ๐ ~~ (chแป cแบงn thay ฤแปi max_allowed_packet)
  Vแบฅn ฤแป cรฒn lแบกi lร vแบฅn ฤแป nแปi lแบกi chuyแปn giao tแบกi mแปt ฤiแปm dแปซng, tรดi sแบฝ suy nghฤฉ vแป vแบฅn ฤแป nรy sau.

# Demo (bแบฅt cแปฉ lรบc nรo GG)
  <https://mayx.leanapp.cn/up.php>

# Kแบฟ hoแบกch cแบฃi tiแบฟn tiแบฟp theo
  ~~ Tรดi muแปn tแบฃi lรชn mแปt phแบงn ฤแป tแบฃi lรชn khรดng cรณ giแปi hแบกn vแป kรญch thฦฐแปc tแปp.
  Nhฦฐng ฤiแปu nรy dฦฐแปng nhฦฐ ฤฦฐแปฃc hแป trแปฃ bแปi front-end, vรฌ vแบญy hรฃy ฤแบทt mแปt liรชn kแบฟt แป ฤรขy: <https://github.com/fex-team/webuploader> ~~
  ฤแปซng cรณ kแบฟ hoแบกch cแบฃi thiแปn ...
